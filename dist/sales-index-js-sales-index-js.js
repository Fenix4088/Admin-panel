(window["webpackJsonp"] = window["webpackJsonp"] || []).push([["sales-index-js"],{

/***/ "./src/pages/sales/index.js":
/*!**********************************!*\
  !*** ./src/pages/sales/index.js ***!
  \**********************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"default\", function() { return Page; });\n/* harmony import */ var _components_sortable_table_index_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../components/sortable-table/index.js */ \"./src/components/sortable-table/index.js\");\n/* harmony import */ var _components_range_picker_index_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../components/range-picker/index.js */ \"./src/components/range-picker/index.js\");\n/* harmony import */ var _sales_headers_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./sales-headers.js */ \"./src/pages/sales/sales-headers.js\");\n/* harmony import */ var _utils_fetch_json_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../utils/fetch-json.js */ \"./src/utils/fetch-json.js\");\nfunction _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\n\n\n\n\n\nclass Page {\n  constructor() {\n    _defineProperty(this, \"element\", void 0);\n\n    _defineProperty(this, \"subElements\", {});\n\n    _defineProperty(this, \"components\", {});\n  }\n\n  render() {\n    const element = document.createElement('div');\n    element.innerHTML = this.template;\n    this.element = element.firstElementChild;\n    this.subElements = this.getSubElements(this.element);\n    this.initComponents();\n    this.renderComponents();\n    this.initEventListeners();\n    return this.element;\n  }\n\n  get template() {\n    return \"\\n            <div class=\\\"sales full-height flex-column\\\">\\n            <div class=\\\"content__top-panel\\\">\\n            <h1 class=\\\"page-title\\\">Sales</h1>\\n            <div data-element=\\\"rangePicker\\\" class=\\\"rangepicker\\\">\\n                <!-- Rangepicker component -->\\n            </div>\\n            </div>\\n            <div data-elem=\\\"ordersContainer\\\" class=\\\"full-height flex-column\\\">\\n            <div data-element=\\\"sortableTable\\\" class=\\\"sortable-table\\\">\\n                <!-- Sortable table component -->\\n            </div>\\n            </div>\\n            </div>\\n        \";\n  }\n\n  getSubElements(element) {\n    const elements = element.querySelectorAll('[data-element]');\n    return [...elements].reduce((accum, subElement) => {\n      accum[subElement.dataset.element] = subElement;\n      return accum;\n    }, {});\n  }\n\n  initComponents() {\n    const to = new Date();\n    const from = new Date(to.getTime() - 30 * 24 * 60 * 60 * 1000);\n    const rangePicker = new _components_range_picker_index_js__WEBPACK_IMPORTED_MODULE_1__[\"default\"]({\n      from,\n      to\n    });\n    const sortableTable = new _components_sortable_table_index_js__WEBPACK_IMPORTED_MODULE_0__[\"default\"](_sales_headers_js__WEBPACK_IMPORTED_MODULE_2__[\"default\"], {\n      url: this.getTableUrl(from, to),\n      sorted: {\n        id: 'createdAt',\n        order: 'desc'\n      },\n      start: 0,\n      step: 30\n    });\n    this.saveComponents({\n      rangePicker,\n      sortableTable\n    });\n  }\n\n  saveComponents(items = {}) {\n    Object.keys(items).forEach(item => {\n      this.components[item] = items[item];\n    });\n  }\n\n  renderComponents() {\n    Object.keys(this.components).forEach(component => {\n      const root = this.subElements[component];\n      const {\n        element\n      } = this.components[component];\n      root.append(element);\n    });\n  }\n\n  initEventListeners() {\n    this.components.rangePicker.element.addEventListener('date-select', event => {\n      const {\n        from,\n        to\n      } = event.detail;\n      this.updateComponents(from, to);\n    });\n  }\n\n  async updateComponents(from, to) {\n    const {\n      sorted,\n      step\n    } = this.components.sortableTable;\n    this.components.sortableTable.url = new URL(this.getTableUrl(from, to), \"https://course-js.javascript.ru/\");\n    await this.components.sortableTable.sortOnServer(sorted.id, sorted.order, 0, step);\n  }\n\n  getTableUrl(from, to) {\n    return \"api/rest/orders?createdAt_gte=\".concat(from.toISOString(), \"&createdAt_lte=\").concat(to.toISOString());\n  }\n\n  destroy() {\n    for (const component of Object.values(this.components)) {\n      component.destroy();\n    }\n  }\n\n}//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9zcmMvcGFnZXMvc2FsZXMvaW5kZXguanMuanMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi9zcmMvcGFnZXMvc2FsZXMvaW5kZXguanM/ZGQzZiJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgU29ydGFibGVUYWJsZSBmcm9tICcuLi8uLi9jb21wb25lbnRzL3NvcnRhYmxlLXRhYmxlL2luZGV4LmpzJztcclxuaW1wb3J0IFJhbmdlUGlja2VyIGZyb20gJy4uLy4uL2NvbXBvbmVudHMvcmFuZ2UtcGlja2VyL2luZGV4LmpzJztcclxuaW1wb3J0IGhlYWRlciBmcm9tICcuL3NhbGVzLWhlYWRlcnMuanMnO1xyXG5cclxuaW1wb3J0IGZldGNoSnNvbiBmcm9tICcuLi8uLi91dGlscy9mZXRjaC1qc29uLmpzJ1xyXG5cclxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgUGFnZSB7XHJcbiAgZWxlbWVudDtcclxuICBzdWJFbGVtZW50cyA9IHt9O1xyXG4gIGNvbXBvbmVudHMgPSB7fTtcclxuXHJcbiAgcmVuZGVyKCkge1xyXG4gICAgY29uc3QgZWxlbWVudCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xyXG4gICAgZWxlbWVudC5pbm5lckhUTUwgPSB0aGlzLnRlbXBsYXRlO1xyXG4gICAgdGhpcy5lbGVtZW50ID0gZWxlbWVudC5maXJzdEVsZW1lbnRDaGlsZDtcclxuXHJcbiAgICB0aGlzLnN1YkVsZW1lbnRzID0gdGhpcy5nZXRTdWJFbGVtZW50cyh0aGlzLmVsZW1lbnQpO1xyXG4gICAgdGhpcy5pbml0Q29tcG9uZW50cygpO1xyXG4gICAgdGhpcy5yZW5kZXJDb21wb25lbnRzKCk7XHJcbiAgICB0aGlzLmluaXRFdmVudExpc3RlbmVycygpO1xyXG5cclxuICAgIHJldHVybiB0aGlzLmVsZW1lbnQ7XHJcbiAgfVxyXG5cclxuICBnZXQgdGVtcGxhdGUoKSB7XHJcbiAgICByZXR1cm4gYFxyXG4gICAgICAgICAgICA8ZGl2IGNsYXNzPVwic2FsZXMgZnVsbC1oZWlnaHQgZmxleC1jb2x1bW5cIj5cclxuICAgICAgICAgICAgPGRpdiBjbGFzcz1cImNvbnRlbnRfX3RvcC1wYW5lbFwiPlxyXG4gICAgICAgICAgICA8aDEgY2xhc3M9XCJwYWdlLXRpdGxlXCI+U2FsZXM8L2gxPlxyXG4gICAgICAgICAgICA8ZGl2IGRhdGEtZWxlbWVudD1cInJhbmdlUGlja2VyXCIgY2xhc3M9XCJyYW5nZXBpY2tlclwiPlxyXG4gICAgICAgICAgICAgICAgPCEtLSBSYW5nZXBpY2tlciBjb21wb25lbnQgLS0+XHJcbiAgICAgICAgICAgIDwvZGl2PlxyXG4gICAgICAgICAgICA8L2Rpdj5cclxuICAgICAgICAgICAgPGRpdiBkYXRhLWVsZW09XCJvcmRlcnNDb250YWluZXJcIiBjbGFzcz1cImZ1bGwtaGVpZ2h0IGZsZXgtY29sdW1uXCI+XHJcbiAgICAgICAgICAgIDxkaXYgZGF0YS1lbGVtZW50PVwic29ydGFibGVUYWJsZVwiIGNsYXNzPVwic29ydGFibGUtdGFibGVcIj5cclxuICAgICAgICAgICAgICAgIDwhLS0gU29ydGFibGUgdGFibGUgY29tcG9uZW50IC0tPlxyXG4gICAgICAgICAgICA8L2Rpdj5cclxuICAgICAgICAgICAgPC9kaXY+XHJcbiAgICAgICAgICAgIDwvZGl2PlxyXG4gICAgICAgIGA7XHJcbiAgfVxyXG5cclxuICBnZXRTdWJFbGVtZW50cyhlbGVtZW50KSB7XHJcbiAgICBjb25zdCBlbGVtZW50cyA9IGVsZW1lbnQucXVlcnlTZWxlY3RvckFsbCgnW2RhdGEtZWxlbWVudF0nKTtcclxuXHJcbiAgICByZXR1cm4gWy4uLmVsZW1lbnRzXS5yZWR1Y2UoKGFjY3VtLCBzdWJFbGVtZW50KSA9PiB7XHJcbiAgICAgIGFjY3VtW3N1YkVsZW1lbnQuZGF0YXNldC5lbGVtZW50XSA9IHN1YkVsZW1lbnQ7XHJcblxyXG4gICAgICByZXR1cm4gYWNjdW07XHJcbiAgICB9LCB7fSk7XHJcbiAgfVxyXG5cclxuICBpbml0Q29tcG9uZW50cygpIHtcclxuICAgIGNvbnN0IHRvID0gbmV3IERhdGUoKTtcclxuICAgIGNvbnN0IGZyb20gPSBuZXcgRGF0ZSh0by5nZXRUaW1lKCkgLSAzMCAqIDI0ICogNjAgKiA2MCAqIDEwMDApO1xyXG5cclxuICAgIGNvbnN0IHJhbmdlUGlja2VyID0gbmV3IFJhbmdlUGlja2VyKHsgZnJvbSwgdG8gfSk7XHJcblxyXG4gICAgY29uc3Qgc29ydGFibGVUYWJsZSA9IG5ldyBTb3J0YWJsZVRhYmxlKGhlYWRlciwge1xyXG4gICAgICB1cmw6IHRoaXMuZ2V0VGFibGVVcmwoZnJvbSwgdG8pLFxyXG4gICAgICBzb3J0ZWQ6IHtcclxuICAgICAgICBpZDogJ2NyZWF0ZWRBdCcsXHJcbiAgICAgICAgb3JkZXI6ICdkZXNjJyxcclxuICAgICAgfSxcclxuICAgICAgc3RhcnQ6IDAsXHJcbiAgICAgIHN0ZXA6IDMwLFxyXG4gICAgfSk7XHJcblxyXG4gICAgdGhpcy5zYXZlQ29tcG9uZW50cyh7cmFuZ2VQaWNrZXIsIHNvcnRhYmxlVGFibGV9KTtcclxuICB9XHJcblxyXG4gIHNhdmVDb21wb25lbnRzKGl0ZW1zID0ge30pIHtcclxuICAgIE9iamVjdC5rZXlzKGl0ZW1zKS5mb3JFYWNoKGl0ZW0gPT4ge1xyXG4gICAgICAgIHRoaXMuY29tcG9uZW50c1tpdGVtXSA9IGl0ZW1zW2l0ZW1dO1xyXG4gICAgfSlcclxufVxyXG5cclxuICByZW5kZXJDb21wb25lbnRzKCkge1xyXG4gICAgT2JqZWN0LmtleXModGhpcy5jb21wb25lbnRzKS5mb3JFYWNoKGNvbXBvbmVudCA9PiB7XHJcbiAgICAgIGNvbnN0IHJvb3QgPSB0aGlzLnN1YkVsZW1lbnRzW2NvbXBvbmVudF07XHJcbiAgICAgIGNvbnN0IHsgZWxlbWVudCB9ID0gdGhpcy5jb21wb25lbnRzW2NvbXBvbmVudF07XHJcblxyXG4gICAgICByb290LmFwcGVuZChlbGVtZW50KTtcclxuICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgaW5pdEV2ZW50TGlzdGVuZXJzKCkge1xyXG4gICAgdGhpcy5jb21wb25lbnRzLnJhbmdlUGlja2VyLmVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignZGF0ZS1zZWxlY3QnLCBldmVudCA9PiB7XHJcbiAgICAgIGNvbnN0IHsgZnJvbSwgdG8gfSA9IGV2ZW50LmRldGFpbDtcclxuICAgICAgdGhpcy51cGRhdGVDb21wb25lbnRzKGZyb20sIHRvKTtcclxuICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgYXN5bmMgdXBkYXRlQ29tcG9uZW50cyhmcm9tLCB0bykge1xyXG4gICAgY29uc3Qge3NvcnRlZCwgc3RlcH0gPSB0aGlzLmNvbXBvbmVudHMuc29ydGFibGVUYWJsZTtcclxuICAgIHRoaXMuY29tcG9uZW50cy5zb3J0YWJsZVRhYmxlLnVybCA9IG5ldyBVUkwodGhpcy5nZXRUYWJsZVVybChmcm9tLCB0byksIHByb2Nlc3MuZW52LkJBQ0tFTkRfVVJMKTtcclxuICAgIGF3YWl0IHRoaXMuY29tcG9uZW50cy5zb3J0YWJsZVRhYmxlLnNvcnRPblNlcnZlcihzb3J0ZWQuaWQsIHNvcnRlZC5vcmRlciwgMCwgc3RlcCk7XHJcbiAgfVxyXG5cclxuICBnZXRUYWJsZVVybChmcm9tLCB0bykge1xyXG4gICAgcmV0dXJuIGBhcGkvcmVzdC9vcmRlcnM/Y3JlYXRlZEF0X2d0ZT0ke2Zyb20udG9JU09TdHJpbmcoKX0mY3JlYXRlZEF0X2x0ZT0ke3RvLnRvSVNPU3RyaW5nKCl9YDtcclxuICB9XHJcblxyXG4gIGRlc3Ryb3koKSB7XHJcbiAgICAgIGZvcihjb25zdCBjb21wb25lbnQgb2YgT2JqZWN0LnZhbHVlcyh0aGlzLmNvbXBvbmVudHMpKSB7XHJcbiAgICAgICAgY29tcG9uZW50LmRlc3Ryb3koKTtcclxuICAgICAgfVxyXG4gIH1cclxufVxyXG4iXSwibWFwcGluZ3MiOiI7Ozs7Ozs7O0FBQUE7QUFDQTtBQUNBO0FBRUE7QUFFQTtBQUFBO0FBQUE7QUFDQTtBQURBO0FBQ0E7QUFEQTtBQUFBO0FBQ0E7QUFJQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQWVBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFBQTtBQUFBO0FBQUE7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRkE7QUFJQTtBQUNBO0FBUEE7QUFVQTtBQUFBO0FBQUE7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQUE7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQUE7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQUE7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUF0R0EiLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///./src/pages/sales/index.js\n");

/***/ }),

/***/ "./src/pages/sales/sales-headers.js":
/*!******************************************!*\
  !*** ./src/pages/sales/sales-headers.js ***!
  \******************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\nconst header = [{\n  id: 'id',\n  title: 'ID',\n  sortable: true,\n  sortType: 'number'\n}, {\n  id: 'user',\n  title: 'Client',\n  sortable: true,\n  sortType: 'string'\n}, {\n  id: 'createdAt',\n  title: 'Date',\n  sortable: true,\n  sortType: 'number',\n  template: data => {\n    const date = new Date(data);\n    let options = {\n      year: 'numeric',\n      month: 'long',\n      day: 'numeric'\n    };\n    return \"<div class=\\\"sortable-table__cell\\\"> \".concat(date.toLocaleDateString('en', options), \"</div>\");\n  }\n}, {\n  id: 'totalCost',\n  title: 'Cost',\n  sortable: true,\n  sortType: 'number',\n  template: data => '<div class=\"sortable-table__cell\">$' + data + '</div>'\n}, {\n  id: 'delivery',\n  title: 'Status',\n  sortable: true,\n  sortType: 'string'\n}];\n/* harmony default export */ __webpack_exports__[\"default\"] = (header);//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9zcmMvcGFnZXMvc2FsZXMvc2FsZXMtaGVhZGVycy5qcy5qcyIsInNvdXJjZXMiOlsid2VicGFjazovLy8uL3NyYy9wYWdlcy9zYWxlcy9zYWxlcy1oZWFkZXJzLmpzPzAwOWEiXSwic291cmNlc0NvbnRlbnQiOlsiY29uc3QgaGVhZGVyID0gW1xyXG4gIHtcclxuICAgIGlkOiAnaWQnLFxyXG4gICAgdGl0bGU6ICdJRCcsXHJcbiAgICBzb3J0YWJsZTogdHJ1ZSxcclxuICAgIHNvcnRUeXBlOiAnbnVtYmVyJ1xyXG4gIH0sXHJcbiAge1xyXG4gICAgaWQ6ICd1c2VyJyxcclxuICAgIHRpdGxlOiAnQ2xpZW50JyxcclxuICAgIHNvcnRhYmxlOiB0cnVlLFxyXG4gICAgc29ydFR5cGU6ICdzdHJpbmcnXHJcbiAgfSxcclxuICB7XHJcbiAgICBpZDogJ2NyZWF0ZWRBdCcsXHJcbiAgICB0aXRsZTogJ0RhdGUnLFxyXG4gICAgc29ydGFibGU6IHRydWUsXHJcbiAgICBzb3J0VHlwZTogJ251bWJlcicsXHJcbiAgICB0ZW1wbGF0ZTogZGF0YSA9PiB7XHJcbiAgICAgIGNvbnN0IGRhdGUgPSBuZXcgRGF0ZShkYXRhKTtcclxuICAgICAgbGV0IG9wdGlvbnMgPSB7XHJcbiAgICAgICAgeWVhcjogJ251bWVyaWMnLFxyXG4gICAgICAgIG1vbnRoOiAnbG9uZycsXHJcbiAgICAgICAgZGF5OiAnbnVtZXJpYydcclxuICAgICAgfTtcclxuICAgICAgcmV0dXJuIGA8ZGl2IGNsYXNzPVwic29ydGFibGUtdGFibGVfX2NlbGxcIj4gJHtkYXRlLnRvTG9jYWxlRGF0ZVN0cmluZygnZW4nLCBvcHRpb25zKX08L2Rpdj5gO1xyXG4gICAgfVxyXG4gIH0sXHJcbiAge1xyXG4gICAgaWQ6ICd0b3RhbENvc3QnLFxyXG4gICAgdGl0bGU6ICdDb3N0JyxcclxuICAgIHNvcnRhYmxlOiB0cnVlLFxyXG4gICAgc29ydFR5cGU6ICdudW1iZXInLFxyXG4gICAgdGVtcGxhdGU6IGRhdGEgPT4gJzxkaXYgY2xhc3M9XCJzb3J0YWJsZS10YWJsZV9fY2VsbFwiPiQnICsgZGF0YSArICc8L2Rpdj4nXHJcbiAgfSxcclxuICB7XHJcbiAgICBpZDogJ2RlbGl2ZXJ5JyxcclxuICAgIHRpdGxlOiAnU3RhdHVzJyxcclxuICAgIHNvcnRhYmxlOiB0cnVlLFxyXG4gICAgc29ydFR5cGU6ICdzdHJpbmcnXHJcbiAgfVxyXG5dO1xyXG5cclxuZXhwb3J0IGRlZmF1bHQgaGVhZGVyO1xyXG4iXSwibWFwcGluZ3MiOiJBQUFBO0FBQUE7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUpBO0FBT0E7QUFDQTtBQUNBO0FBQ0E7QUFKQTtBQU9BO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBSEE7QUFLQTtBQUNBO0FBYkE7QUFnQkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUxBO0FBUUE7QUFDQTtBQUNBO0FBQ0E7QUFKQTtBQVFBIiwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///./src/pages/sales/sales-headers.js\n");

/***/ })

}]);