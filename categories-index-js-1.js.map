{"version":3,"sources":["webpack:///./src/pages/categories/index.js","webpack:///./src/utils/fetch-json.js","webpack:///./src/components/notification/index.js","webpack:///./src/components/sortable-list/index.js"],"names":["Page","async","targetChildNodes","event","target","childNodes","requestData","map","item","id","dataset","weight","indexOf","fetchJson","process","method","headers","body","JSON","stringify","this","showNotificationMessage","error","console","closest","classList","toggle","initEventListeners","subElements","categoriesContainer","addEventListener","onPointerDown","document","reorderingEvent","messageText","messageType","NotificationMessage","type","show","response","getCategoriesData","element","createElement","innerHTML","template","firstElementChild","getSubElements","createCategorieWrap","listContainers","getAllListsContainers","getCategoriestList","url","getRequestLink","requestString","newUrl","URL","searchParams","set","href","data","categoriesMarkup","dataItem","title","join","forEach","items","getCategoriesListItem","sortableList","SortableList","components","append","subcategories","subcategory","wrapper","count","querySelectorAll","reduce","acc","index","destroy","removeEventListener","component","Object","values","params","fetch","toString","err","FetchError","ok","errorText","statusText","json","message","status","Error","constructor","super","window","reason","alert","duration","notificationStatus","remove","render","markup","setTimeout","which","itemElem","preventDefault","dragStart","clientX","clientY","moveDraggingAt","children","top","firstElementTop","getBoundingClientRect","bottom","movePlaceholderAt","length","i","li","draggingElem","offsetHeight","height","scrollIfCloseToWindowEdge","dragStop","className","addItems","add","elementInitialIndex","pointerInitialShift","x","y","placeholderElem","style","width","offsetWidth","after","onDocumentPointerMove","onDocumentPointerUp","left","currentElement","insertBefore","placeholderIndex","replaceWith","dispatchEvent","CustomEvent","bubbles","detail","from","to","scrollBy","documentElement","clientHeight"],"mappings":"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","file":"categories-index-js-1.js","sourcesContent":["import fetchJson from '../../utils/fetch-json.js';\r\n\r\nimport NotificationMessage from '../../components/notification/index.js';\r\nimport SortableList from '../../components/sortable-list/index.js';\r\n\r\nexport default class Page {\r\n  element;\r\n  components = {};\r\n  subElements = {};\r\n  listContainers = {};\r\n\r\n  initEventListeners() {\r\n    this.subElements.categoriesContainer.addEventListener('pointerdown', this.onPointerDown);\r\n    document.addEventListener('sortable-list-reorder', this.reorderingEvent);\r\n  }\r\n\r\n  reorderingEvent = async event => {\r\n    const targetChildNodes = event.target.childNodes;\r\n\r\n    const requestData = [...targetChildNodes].map(item => {\r\n      const id = item.dataset.id;\r\n      const weight = [...targetChildNodes].indexOf(item) + 1;\r\n      return { id, weight };\r\n    });\r\n\r\n    try {\r\n      await fetchJson(`${process.env.BACKEND_URL}api/rest/subcategories`, {\r\n        method: 'PATCH',\r\n        headers: {\r\n          'Content-Type': 'application/json'\r\n        },\r\n        body: JSON.stringify(requestData)\r\n      });\r\n\r\n      this.showNotificationMessage('Category order saved', 'success');\r\n\r\n    } catch (error) {\r\n      this.showNotificationMessage('Category order NOT saved', 'error');\r\n      console.error('something went wrong', error);\r\n    }\r\n  };\r\n\r\n  showNotificationMessage(messageText, messageType) {\r\n    const notificationMessage = new NotificationMessage(messageText, { type: messageType });\r\n    notificationMessage.show();\r\n  }\r\n\r\n  onPointerDown = event => {\r\n    if (event.target.closest('.category')) {\r\n      if (!event.target.closest('.categories__sortable-list-item')) {\r\n        const currentElement = event.target.closest('.category');\r\n        currentElement.classList.toggle('category_open');\r\n      }\r\n    }\r\n  };\r\n\r\n  async render() {\r\n    const response = await this.getCategoriesData();\r\n    const element = document.createElement('div');\r\n    element.innerHTML = this.template;\r\n    this.element = element.firstElementChild;\r\n\r\n    this.subElements = this.getSubElements(this.element);\r\n\r\n    this.createCategorieWrap(response);\r\n\r\n    this.listContainers = this.getAllListsContainers(this.element);\r\n\r\n    this.getCategoriestList(response);\r\n    this.initEventListeners();\r\n\r\n\r\n    return this.element;\r\n  }\r\n\r\n  get template() {\r\n    return `  \r\n        <div class=\"categories\">\r\n        <div class=\"content__top-panel\">\r\n          <h1 class=\"page-title\">Categories</h1>\r\n        </div>\r\n        <div data-element=\"categoriesContainer\">\r\n            <!-- Render categories menue here -->\r\n        </div>\r\n        </div>\r\n      `;\r\n  }\r\n\r\n  async getCategoriesData() {\r\n    const url = this.getRequestLink('/api/rest/categories');\r\n    return await fetchJson(url);\r\n  }\r\n\r\n  getRequestLink(requestString) {\r\n    const newUrl = new URL(requestString, `${process.env.BACKEND_URL}`);\r\n\r\n    newUrl.searchParams.set('_sort', 'weight');\r\n    newUrl.searchParams.set('_refs', 'subcategory');\r\n\r\n    return newUrl.href;\r\n  }\r\n\r\n  createCategorieWrap(data = []) {\r\n    const { categoriesContainer } = this.subElements;\r\n    const categoriesMarkup = data\r\n      .map(dataItem => {\r\n        return `\r\n            <div class=\"category category_open\" data-id=\"${dataItem.id}\">\r\n            <header class=\"category__header\">\r\n                ${dataItem.title}\r\n            </header>\r\n            <div class=\"category__body\">\r\n                <div class=\"subcategory-list\">\r\n                    <div class=\"sortable-list\" data-element=\"listContainer\" data-index=\"${dataItem.id}\">\r\n\r\n                    </div>\r\n                    </div>\r\n                    </div>\r\n                    </div>`;\r\n      })\r\n      .join('');\r\n\r\n    categoriesContainer.innerHTML = categoriesMarkup;\r\n  }\r\n\r\n  getCategoriestList(data) {\r\n    data.forEach(dataItem => {\r\n      const items = this.getCategoriesListItem(dataItem);\r\n      const sortableList = new SortableList({ items });\r\n\r\n      this.components[dataItem.id] = sortableList;\r\n\r\n      this.listContainers[dataItem.id].append(sortableList.element);\r\n    });\r\n  }\r\n\r\n  getCategoriesListItem(data) {\r\n    const { subcategories } = data;\r\n    return subcategories.map(subcategory => {\r\n      const wrapper = document.createElement('div');\r\n      wrapper.innerHTML = `\r\n            <li class=\"categories__sortable-list-item sortable-list__item\" data-grab-handle=\"\" data-id=\"${subcategory.id}\">\r\n                <strong>${subcategory.title}</strong>\r\n                <span><b>${subcategory.count}</b> products</span>\r\n            </li>`;\r\n\r\n      return wrapper.firstElementChild;\r\n    });\r\n  }\r\n\r\n  getSubElements(element) {\r\n    const elements = element.querySelectorAll('[data-element]');\r\n\r\n    return [...elements].reduce((acc, item) => {\r\n      acc[item.dataset.element] = item;\r\n      return acc;\r\n    }, {});\r\n  }\r\n\r\n  getAllListsContainers(element) {\r\n    const elements = element.querySelectorAll('[data-index]');\r\n    return [...elements].reduce((acc, item) => {\r\n      acc[item.dataset.index] = item;\r\n      return acc;\r\n    }, {});\r\n  }\r\n\r\n  destroy() {\r\n    const {categoriesContainer} = this.subElements;\r\n    categoriesContainer.removeEventListener('pointerdown', this.onPointerDown);\r\n\r\n    for (const component of Object.values(this.components)) {\r\n      component.destroy();\r\n    }\r\n  }\r\n}\r\n","// same as fetch, but throws FetchError in case of errors\r\n// status >= 400 is an error\r\n// network error / json error are errors\r\n\r\nexport default async function(url, params) {\r\n  let response;\r\n\r\n  try {\r\n    // NOTE: \"toString\" call needed for correct work of \"jest-fetch-mock\"\r\n    response = await fetch(url.toString(), params);\r\n  } catch(err) {\r\n    throw new FetchError(response, \"Network error has occurred.\");\r\n  }\r\n\r\n  let body;\r\n\r\n  if (!response.ok) {\r\n    let errorText = response.statusText; // Not Found (for 404)\r\n\r\n    try {\r\n      body = await response.json();\r\n\r\n      errorText = (body.error && body.error.message) || (body.data && body.data.error && body.data.error.message) || errorText;\r\n    } catch (error) { /* ignore failed body */ }\r\n\r\n    let message = `Error ${response.status}: ${errorText}`;\r\n\r\n    throw new FetchError(response, body, message);\r\n  }\r\n\r\n  try {\r\n    return await response.json();\r\n  } catch(err) {\r\n    throw new FetchError(response, null, err.message);\r\n  }\r\n}\r\n\r\nexport class FetchError extends Error {\r\n  name = \"FetchError\";\r\n\r\n  constructor(response, body, message) {\r\n    super(message);\r\n    this.response = response;\r\n    this.body = body;\r\n  }\r\n}\r\n\r\n// handle uncaught failed fetch through\r\nwindow.addEventListener('unhandledrejection', event => {\r\n  if (event.reason instanceof FetchError) {\r\n    alert(event.reason.message);\r\n  }\r\n});\r\n\r\n","export default class NotificationMessage {\r\n  element;\r\n  static notificationStatus;\r\n\r\n  constructor(messageText, { duration = 2000, type = 'success' } = {}) {\r\n    if (NotificationMessage.notificationStatus) {\r\n      NotificationMessage.notificationStatus.remove();\r\n    }\r\n    this.messageText = messageText;\r\n    this.duration = duration;\r\n    this.type = type;\r\n    this.render();\r\n  }\r\n\r\n  get markup() {\r\n    return `\r\n          <div class=\"notification ${this.type}\" style=\"--value:${this.duration / 1000}s\">\r\n          <div class=\"timer\"></div>\r\n          <div class=\"inner-wrapper\">\r\n          <div class=\"notification-header\">${this.type}</div>\r\n          <div class=\"notification-body\">\r\n              ${this.messageText}\r\n          </div>\r\n          </div>\r\n      </div>\r\n        `;\r\n  }\r\n\r\n  render() {\r\n    const element = document.createElement('div');\r\n    element.innerHTML = this.markup;\r\n    this.element = element.firstElementChild;\r\n\r\n    NotificationMessage.notificationStatus = this.element;\r\n  }\r\n\r\n  show(target = document.body) {\r\n    target.append(this.element);\r\n    setTimeout(() => {\r\n      this.remove();\r\n      this.destroy();\r\n    }, this.duration);\r\n  }\r\n\r\n  remove() {\r\n    this.element.remove();\r\n  }\r\n\r\n  destroy() {\r\n    this.element = null;\r\n    NotificationMessage.notificationStatus = null;\r\n  }\r\n}\r\n","export default class SortableList {\r\n  element;\r\n  elementInitialIndex;\r\n  pointerInitialShift = {};\r\n  draggingElem;\r\n  placeholderElem;\r\n\r\n  constructor({ items = [] } = {}) {\r\n    this.items = items;\r\n\r\n    this.render();\r\n  }\r\n\r\n  render() {\r\n    this.element = document.createElement(\"ul\");\r\n    this.element.className = \"sortable-list\";\r\n\r\n    this.addItems();\r\n    this.initEventListeners();\r\n  }\r\n\r\n  initEventListeners() {\r\n    this.element.addEventListener(\"pointerdown\", this.onPointerDown);\r\n  }\r\n\r\n  addItems() {\r\n    for (let item of this.items) {\r\n      item.classList.add(\"sortable-list__item\");\r\n    }\r\n    this.element.append(...this.items);\r\n  }\r\n\r\n  onPointerDown = (event) => {\r\n    if (event.which !== 1) {\r\n      // must be left-button\r\n      return false;\r\n    }\r\n\r\n    const itemElem = event.target.closest(\".sortable-list__item\");\r\n\r\n    if (itemElem) {\r\n      event.preventDefault();\r\n      if (event.target.closest(\"[data-grab-handle]\")) {\r\n        this.dragStart(itemElem, event);\r\n      }\r\n\r\n      if (event.target.closest(\"[data-delete-handle]\")) {\r\n        itemElem.remove();\r\n      }\r\n    }\r\n  };\r\n\r\n  dragStart(itemElem, event) {\r\n    const { clientX, clientY } = event;\r\n\r\n    this.elementInitialIndex = [...this.element.children].indexOf(itemElem);\r\n\r\n    this.pointerInitialShift = {\r\n      x: clientX - itemElem.getBoundingClientRect().x,\r\n      y: clientY - itemElem.getBoundingClientRect().y,\r\n    };\r\n\r\n    this.draggingElem = itemElem;\r\n\r\n    // Create a placeholder\r\n    this.placeholderElem = document.createElement(\"li\");\r\n    this.placeholderElem.className = \"sortable-list__placeholder\";\r\n\r\n    // itemElem will get position:fixed\r\n    // so its width will be auto-set to fit the parent container\r\n    itemElem.style.width = `${itemElem.offsetWidth}px`;\r\n    itemElem.style.height = `${itemElem.offsetHeight}px`;\r\n\r\n    this.placeholderElem.style.width = itemElem.style.width;\r\n    this.placeholderElem.style.height = itemElem.style.height;\r\n\r\n    itemElem.classList.add(\"sortable-list__item_dragging\");\r\n\r\n    itemElem.after(this.placeholderElem);\r\n\r\n    // move to the end, to be over other list elements\r\n    this.element.append(itemElem);\r\n\r\n    this.moveDraggingAt(clientX, clientY);\r\n\r\n    document.addEventListener(\"pointermove\", this.onDocumentPointerMove);\r\n    document.addEventListener(\"pointerup\", this.onDocumentPointerUp);\r\n  }\r\n\r\n  onDocumentPointerMove = (event) => {\r\n    const { clientX, clientY } = event;\r\n\r\n    this.moveDraggingAt(clientX, clientY);\r\n\r\n    const { firstElementChild, children } = this.element;\r\n    const { top: firstElementTop } = firstElementChild.getBoundingClientRect();\r\n    const { bottom } = this.element.getBoundingClientRect();\r\n\r\n    if (clientY < firstElementTop) {\r\n      this.movePlaceholderAt(0);\r\n    } else if (clientY > bottom) {\r\n      this.movePlaceholderAt(children.length);\r\n    } else {\r\n      for (let i = 0; i < children.length; i++) {\r\n        const li = children[i];\r\n        // ignore to prevent bugs when dragging between elements\r\n        if (li !== this.draggingElem) {\r\n          const { top, bottom } = li.getBoundingClientRect();\r\n          const { offsetHeight: height } = li;\r\n\r\n          if (clientY > top && clientY < bottom) {\r\n            // inside the element (y-axis)\r\n            if (clientY < top + height / 2) {\r\n              // upper half of the element\r\n              this.movePlaceholderAt(i);\r\n              break;\r\n            } else {\r\n              // lower half of the element\r\n              this.movePlaceholderAt(i + 1);\r\n              break;\r\n            }\r\n          }\r\n        }\r\n      }\r\n    }\r\n\r\n    this.scrollIfCloseToWindowEdge(clientY);\r\n  };\r\n\r\n  moveDraggingAt(clientX, clientY) {\r\n    this.draggingElem.style.left = clientX - this.pointerInitialShift.x + \"px\";\r\n    this.draggingElem.style.top = clientY - this.pointerInitialShift.y + \"px\";\r\n  }\r\n\r\n  movePlaceholderAt(index) {\r\n    const currentElement = this.element.children[index];\r\n\r\n    if (currentElement !== this.placeholderElem) {\r\n      this.element.insertBefore(this.placeholderElem, currentElement);\r\n    }\r\n  }\r\n\r\n  onDocumentPointerUp = (event) => {\r\n    this.dragStop();\r\n  };\r\n\r\n  dragStop() {\r\n    const placeholderIndex = [...this.element.children].indexOf(\r\n      this.placeholderElem\r\n    );\r\n\r\n    // drop element back\r\n    this.placeholderElem.replaceWith(this.draggingElem);\r\n    this.draggingElem.classList.remove(\"sortable-list__item_dragging\");\r\n\r\n    this.draggingElem.style.left = \"\";\r\n    this.draggingElem.style.top = \"\";\r\n    this.draggingElem.style.width = \"\";\r\n    this.draggingElem.style.height = \"\";\r\n\r\n    document.removeEventListener(\"pointermove\", this.onDocumentPointerMove);\r\n    document.removeEventListener(\"pointerup\", this.onDocumentPointerUp);\r\n\r\n    this.draggingElem = null;\r\n\r\n    if (placeholderIndex !== this.elementInitialIndex) {\r\n      this.element.dispatchEvent(\r\n        new CustomEvent(\"sortable-list-reorder\", {\r\n          bubbles: true,\r\n          detail: {\r\n            from: this.elementInitialIndex,\r\n            to: placeholderIndex,\r\n          },\r\n        })\r\n      );\r\n    }\r\n  }\r\n\r\n  scrollIfCloseToWindowEdge(clientY) {\r\n    const scrollingValue = 10;\r\n    const threshold = 20;\r\n\r\n    if (clientY < threshold) {\r\n      window.scrollBy(0, -scrollingValue);\r\n    } else if (clientY > document.documentElement.clientHeight - threshold) {\r\n      window.scrollBy(0, scrollingValue);\r\n    }\r\n  }\r\n\r\n  remove() {\r\n    this.element.remove();\r\n    document.removeEventListener(\"pointermove\", this.onDocumentPointerMove);\r\n    document.removeEventListener(\"pointerup\", this.onDocumentPointerUp);\r\n  }\r\n\r\n  destroy() {\r\n    this.remove();\r\n  }\r\n}\r\n"],"sourceRoot":""}